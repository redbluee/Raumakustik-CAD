
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Paula Klein, Deniz Sharideh, Linus Staubach">
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../api/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Graphical User Interface - RoomAcousticWizard</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#graphical-user-interface" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="RoomAcousticWizard" class="md-header__button md-logo" aria-label="RoomAcousticWizard" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RoomAcousticWizard
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Graphical User Interface
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/redbluee/Raumakustik-CAD" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    redbluee/Raumakustik-CAD
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Graphical User Interface

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
  
    
  
  Calculation Backend

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../materials/" class="md-tabs__link">
        
  
  
    
  
  Database Integration

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="RoomAcousticWizard" class="md-nav__button md-logo" aria-label="RoomAcousticWizard" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    RoomAcousticWizard
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/redbluee/Raumakustik-CAD" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    redbluee/Raumakustik-CAD
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Graphical User Interface
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Graphical User Interface
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pages.home" class="md-nav__link">
    <span class="md-ellipsis">
      home
    </span>
  </a>
  
    <nav class="md-nav" aria-label="home">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pages.home.add_row_to_surface_table" class="md-nav__link">
    <span class="md-ellipsis">
      add_row_to_surface_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pages.home.handle_table_interactions" class="md-nav__link">
    <span class="md-ellipsis">
      handle_table_interactions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pages.home.update_area_table_with_material" class="md-nav__link">
    <span class="md-ellipsis">
      update_area_table_with_material
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pages.home.update_graph_with_calculation" class="md-nav__link">
    <span class="md-ellipsis">
      update_graph_with_calculation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pages.home.validate_and_format_table_data" class="md-nav__link">
    <span class="md-ellipsis">
      validate_and_format_table_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calculation Backend
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../materials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Integration
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="graphical-user-interface">Graphical User Interface</h1>


<div class="doc doc-object doc-module">



<h2 id="pages.home" class="doc doc-heading">
            <code>pages.home</code>


</h2>

    <div class="doc doc-contents first">

        <p>This module defines the layout and callbacks for the home page of the reverberation
optimization application. It includes components for inputting room parameters,
defining room surfaces, and visualizing the calculated reverberation time.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pages.home.add_row_to_surface_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_row_to_surface_table</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a new row to the surface definition table.</p>
<p>This callback is triggered when the "Add Row" button is clicked. It appends a new,
empty row to the <code>area-table</code> DataTable, allowing users to define another room surface.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_clicks</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of times the 'add-row-button' has been clicked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rows</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The existing data in the 'area-table'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated data for the 'area-table' with the new row added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pages/home.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="c1"># allow_duplicate needed if another callback modifies data</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;add-row-button&#39;</span><span class="p">,</span> <span class="s1">&#39;n_clicks&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_row_to_surface_table</span><span class="p">(</span><span class="n">n_clicks</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a new row to the surface definition table.</span>

<span class="sd">    This callback is triggered when the &quot;Add Row&quot; button is clicked. It appends a new,</span>
<span class="sd">    empty row to the `area-table` DataTable, allowing users to define another room surface.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n_clicks : int</span>
<span class="sd">        The number of times the &#39;add-row-button&#39; has been clicked.</span>
<span class="sd">    rows : list</span>
<span class="sd">        The existing data in the &#39;area-table&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        The updated data for the &#39;area-table&#39; with the new row added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_row_data</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;col-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;💾&quot;</span> <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;col-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;col-3&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">)}</span>
    <span class="n">new_row_data</span><span class="p">[</span><span class="s2">&quot;col-delete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;🗑️&quot;</span> <span class="c1"># Add delete icon to new rows</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pages.home.handle_table_interactions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">handle_table_interactions</span><span class="p">(</span><span class="n">active_cell</span><span class="p">,</span> <span class="n">close_clicks</span><span class="p">,</span> <span class="n">modal_is_open</span><span class="p">,</span> <span class="n">table_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Handle interactions with the main table.</p>
<p>This callback manages two user interactions:
1. Opens a material selection modal when the database icon ('💾') is clicked.
2. Deletes a row from the table when the delete icon ('🗑️') is clicked.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>active_cell</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The currently active cell in the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>close_clicks</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of clicks on the close button.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>modal_is_open</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current state of the modal.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_data</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current data in the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the updated modal state, new modal content,
updated table data, and the stored active row index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pages/home.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;details-modal&quot;</span><span class="p">,</span> <span class="s2">&quot;is_open&quot;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s2">&quot;details-modal-body-content&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="c1"># Keep allow_duplicate if other callbacks modify data</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;active-row-index-store&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;area-table&quot;</span><span class="p">,</span> <span class="s2">&quot;active_cell&quot;</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;close-details-modal-button&quot;</span><span class="p">,</span> <span class="s2">&quot;n_clicks&quot;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s2">&quot;details-modal&quot;</span><span class="p">,</span> <span class="s2">&quot;is_open&quot;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s2">&quot;area-table&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">),</span> 
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_table_interactions</span><span class="p">(</span><span class="n">active_cell</span><span class="p">,</span> <span class="n">close_clicks</span><span class="p">,</span> <span class="n">modal_is_open</span><span class="p">,</span> <span class="n">table_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle interactions with the main table.</span>

<span class="sd">    This callback manages two user interactions:</span>
<span class="sd">    1. Opens a material selection modal when the database icon (&#39;💾&#39;) is clicked.</span>
<span class="sd">    2. Deletes a row from the table when the delete icon (&#39;🗑️&#39;) is clicked.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    active_cell : dict</span>
<span class="sd">        The currently active cell in the table.</span>
<span class="sd">    close_clicks : int</span>
<span class="sd">        Number of clicks on the close button.</span>
<span class="sd">    modal_is_open : bool</span>
<span class="sd">        Current state of the modal.</span>
<span class="sd">    table_data : list</span>
<span class="sd">        Current data in the table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        A tuple containing the updated modal state, new modal content,</span>
<span class="sd">        updated table data, and the stored active row index.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="n">ctx</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">callback_context</span>
    <span class="n">triggered_id</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">triggered</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;prop_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">new_modal_state</span> <span class="o">=</span> <span class="n">modal_is_open</span>
    <span class="n">new_modal_content</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>
    <span class="n">new_table_data</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span> 
    <span class="n">stored_row_index</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

    <span class="k">if</span> <span class="n">triggered_id</span> <span class="o">==</span> <span class="s2">&quot;close-details-modal-button&quot;</span><span class="p">:</span>
        <span class="n">new_modal_state</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">new_modal_state</span><span class="p">,</span> <span class="n">new_modal_content</span><span class="p">,</span> <span class="n">new_table_data</span><span class="p">,</span> <span class="n">stored_row_index</span>

    <span class="k">if</span> <span class="n">active_cell</span> <span class="ow">and</span> <span class="n">table_data</span><span class="p">:</span>
        <span class="n">row_index</span> <span class="o">=</span> <span class="n">active_cell</span><span class="p">[</span><span class="s2">&quot;row&quot;</span><span class="p">]</span>
        <span class="n">col_id</span> <span class="o">=</span> <span class="n">active_cell</span><span class="p">[</span><span class="s2">&quot;column_id&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">row_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_data</span><span class="p">):</span>
            <span class="c1"># Click action on DB icon in the main table</span>
            <span class="k">if</span> <span class="n">col_id</span> <span class="o">==</span> <span class="s2">&quot;col-3&quot;</span><span class="p">:</span>
                <span class="n">stored_row_index</span> <span class="o">=</span> <span class="n">row_index</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">df_materials</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">modal_table_component</span> <span class="o">=</span> <span class="n">dash_table</span><span class="o">.</span><span class="n">DataTable</span><span class="p">(</span>
                        <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;material-selection-table&#39;</span><span class="p">,</span>
                        <span class="n">columns</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">i</span><span class="p">}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_materials</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">df_materials</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">),</span> <span class="c1"># type: ignore</span>
                        <span class="n">style_table</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;overflowY&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;400px&#39;</span><span class="p">,</span> <span class="s1">&#39;overflowX&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;minWidth&#39;</span><span class="p">:</span> <span class="s1">&#39;100%&#39;</span><span class="p">},</span>
                        <span class="n">style_cell</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;textAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;5px&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="s1">&#39;1px solid black&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;whiteSpace&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span>
                        <span class="p">},</span>
                        <span class="n">style_header</span><span class="o">=</span><span class="p">{</span>
                            <span class="s1">&#39;backgroundColor&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb(230, 230, 230)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="s1">&#39;1px solid black&#39;</span>
                        <span class="p">},</span>
                    <span class="p">)</span>
                    <span class="n">new_modal_content</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span>
                        <span class="n">modal_table_component</span><span class="p">,</span> 
                        <span class="n">className</span><span class="o">=</span><span class="s1">&#39;material-table-container&#39;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_modal_content</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">Div</span><span class="p">(</span><span class="s2">&quot;Material database (materials.csv) not found.&quot;</span><span class="p">)</span>

                <span class="n">new_modal_state</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="n">col_id</span> <span class="o">==</span> <span class="s2">&quot;col-delete&quot;</span><span class="p">:</span> <span class="c1"># Click on Delete icon in the main table</span>
                <span class="n">updated_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table_data</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">row_index</span><span class="p">]</span>
                <span class="n">new_table_data</span> <span class="o">=</span> <span class="n">updated_rows</span>
                <span class="n">new_modal_state</span> <span class="o">=</span> <span class="kc">False</span> 
                <span class="k">return</span> <span class="n">new_modal_state</span><span class="p">,</span> <span class="n">new_modal_content</span><span class="p">,</span> <span class="n">new_table_data</span><span class="p">,</span> <span class="n">stored_row_index</span>

    <span class="k">return</span> <span class="n">new_modal_state</span><span class="p">,</span> <span class="n">new_modal_content</span><span class="p">,</span> <span class="n">new_table_data</span><span class="p">,</span> <span class="n">stored_row_index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pages.home.update_area_table_with_material" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_area_table_with_material</span><span class="p">(</span><span class="n">active_cell</span><span class="p">,</span> <span class="n">material_data</span><span class="p">,</span> <span class="n">active_row_index</span><span class="p">,</span> <span class="n">area_table_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update the area table with data from the selected material of the material database.</p>
<p>This callback is triggered when a cell in the material selection modal table is clicked.
It takes the absorption coefficient data from the selected material and populates the
corresponding row in the main 'area-table'.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>active_cell</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The activated cell in the 'material-selection-table'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>material_data</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data from the 'material-selection-table'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>active_row_index</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the row in 'area-table' to be updated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>area_table_data</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current data in the 'area-table'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the updated 'area-table' data and a boolean to close the modal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pages/home.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;details-modal&#39;</span><span class="p">,</span> <span class="s1">&#39;is_open&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;material-selection-table&#39;</span><span class="p">,</span> <span class="s1">&#39;active_cell&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;material-selection-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;active-row-index-store&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_area_table_with_material</span><span class="p">(</span><span class="n">active_cell</span><span class="p">,</span> <span class="n">material_data</span><span class="p">,</span> <span class="n">active_row_index</span><span class="p">,</span> <span class="n">area_table_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the area table with data from the selected material of the material database.</span>

<span class="sd">    This callback is triggered when a cell in the material selection modal table is clicked.</span>
<span class="sd">    It takes the absorption coefficient data from the selected material and populates the</span>
<span class="sd">    corresponding row in the main &#39;area-table&#39;.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    active_cell : dict</span>
<span class="sd">        The activated cell in the &#39;material-selection-table&#39;.</span>
<span class="sd">    material_data : list</span>
<span class="sd">        The data from the &#39;material-selection-table&#39;.</span>
<span class="sd">    active_row_index : int</span>
<span class="sd">        The index of the row in &#39;area-table&#39; to be updated.</span>
<span class="sd">    area_table_data : list</span>
<span class="sd">        The current data in the &#39;area-table&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        A tuple containing the updated &#39;area-table&#39; data and a boolean to close the modal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">active_cell</span> <span class="ow">or</span> <span class="n">active_row_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

    <span class="n">selected_material_row_index</span> <span class="o">=</span> <span class="n">active_cell</span><span class="p">[</span><span class="s1">&#39;row&#39;</span><span class="p">]</span>
    <span class="n">selected_material</span> <span class="o">=</span> <span class="n">material_data</span><span class="p">[</span><span class="n">selected_material_row_index</span><span class="p">]</span>

    <span class="c1"># The row from area-table to be updated</span>
    <span class="n">target_row</span> <span class="o">=</span> <span class="n">area_table_data</span><span class="p">[</span><span class="n">active_row_index</span><span class="p">]</span>

    <span class="c1"># Update the values</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;63&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;125&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;250&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;500&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-9&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;1000&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;2000&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-11&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;4000&#39;</span><span class="p">]</span>
    <span class="n">target_row</span><span class="p">[</span><span class="s1">&#39;col-12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_material</span><span class="p">[</span><span class="s1">&#39;8000&#39;</span><span class="p">]</span>

    <span class="c1"># Close modal</span>
    <span class="k">return</span> <span class="n">area_table_data</span><span class="p">,</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pages.home.update_graph_with_calculation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_graph_with_calculation</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">humidity</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">room_usage</span><span class="p">,</span> <span class="n">air_damp_activated</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update the graph based on all user inputs by calling the calculation module.</p>
<p>This callback gathers all room parameters and surface definitions from the user interface,
passes them to the <code>reverberation_calc</code> module for calculation, and plots the resulting
reverberation time on the graph. It also plots target reverberation time ranges based on
DIN 18041 if a room usage type is selected.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_data</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data from the surface definition table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>volume</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Room volume in cubic meters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>height</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Room height in meters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>temp</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Room temperature in degrees Celsius.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>humidity</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative humidity in percent.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pressure</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Air pressure in hPa.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>room_usage</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Selected room usage type from the dropdown.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>air_damp_activated</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State of the air dampening toggle switch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An updated Plotly figure with the calculated reverberation time.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>pages/home.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;fig-transformed&#39;</span><span class="p">,</span> <span class="s1">&#39;figure&#39;</span><span class="p">),</span>
    <span class="p">[</span>
        <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input_room_volume&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input_room_height&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input_room_temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input_room_humidity&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;input_room_pressure&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;dropdown_room_usage&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
        <span class="n">Input</span><span class="p">(</span><span class="s2">&quot;my-toggle-switch&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_graph_with_calculation</span><span class="p">(</span><span class="n">table_data</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">humidity</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">room_usage</span><span class="p">,</span> <span class="n">air_damp_activated</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the graph based on all user inputs by calling the calculation module.</span>

<span class="sd">    This callback gathers all room parameters and surface definitions from the user interface,</span>
<span class="sd">    passes them to the `reverberation_calc` module for calculation, and plots the resulting</span>
<span class="sd">    reverberation time on the graph. It also plots target reverberation time ranges based on</span>
<span class="sd">    DIN 18041 if a room usage type is selected.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    table_data : list[dict]</span>
<span class="sd">        Data from the surface definition table.</span>
<span class="sd">    volume : float</span>
<span class="sd">        Room volume in cubic meters.</span>
<span class="sd">    height : float, optional</span>
<span class="sd">        Room height in meters.</span>
<span class="sd">    temp : float</span>
<span class="sd">        Room temperature in degrees Celsius.</span>
<span class="sd">    humidity : float</span>
<span class="sd">        Relative humidity in percent.</span>
<span class="sd">    pressure : float</span>
<span class="sd">        Air pressure in hPa.</span>
<span class="sd">    room_usage : str</span>
<span class="sd">        Selected room usage type from the dropdown.</span>
<span class="sd">    air_damp_activated : bool</span>
<span class="sd">        State of the air dampening toggle switch.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    plotly.graph_objects.Figure</span>
<span class="sd">        An updated Plotly figure with the calculated reverberation time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Helper to convert input to float, handling commas.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_float</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">default</span>

    <span class="c1"># Default values for numeric inputs</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="n">to_float</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">to_float</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">to_float</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">humidity</span> <span class="o">=</span> <span class="n">to_float</span><span class="p">(</span><span class="n">humidity</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">pressure</span> <span class="o">=</span> <span class="n">to_float</span><span class="p">(</span><span class="n">pressure</span><span class="p">,</span> <span class="mf">1013.25</span><span class="p">)</span> <span class="c1"># hPa</span>

    <span class="c1"># Standard octave bands for the x-axis</span>
    <span class="n">frequency_bands</span> <span class="o">=</span> <span class="p">[</span><span class="mi">63</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">]</span>

    <span class="c1"># Create a default empty figure and pre-format the axes</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Please provide room volume and surface data for calculation&quot;</span><span class="p">,</span>
        <span class="n">template</span><span class="o">=</span><span class="s2">&quot;plotly_dark&quot;</span><span class="p">,</span>
        <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0,0,0,0)&quot;</span><span class="p">,</span>
        <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;rgba(0,0,0,0)&quot;</span><span class="p">,</span>
        <span class="n">font_color</span><span class="o">=</span><span class="s2">&quot;#f6f6f6&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="n">tickvals</span><span class="o">=</span><span class="n">frequency_bands</span><span class="p">,</span>
            <span class="n">ticktext</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">frequency_bands</span><span class="p">],</span>
            <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10000</span><span class="p">)]</span>  <span class="c1"># Set a fixed range for log axis</span>
        <span class="p">),</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Reverberation Time in s&quot;</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">volume</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">table_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Create Room Object</span>
        <span class="n">calc_room</span> <span class="o">=</span> <span class="n">reverberation_calc</span><span class="o">.</span><span class="n">room</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">height</span><span class="p">:</span>
            <span class="n">calc_room</span><span class="o">.</span><span class="n">set_height</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
        <span class="n">calc_room</span><span class="o">.</span><span class="n">set_temperature</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">calc_room</span><span class="o">.</span><span class="n">set_rel_humidity</span><span class="p">(</span><span class="n">humidity</span><span class="p">)</span>
        <span class="n">calc_room</span><span class="o">.</span><span class="n">set_pressure</span><span class="p">(</span><span class="n">pressure</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Convert hPa to kPa</span>

        <span class="c1"># Create Surface Objects</span>
        <span class="n">surfaces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_data</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Use a helper to safely convert values to float, defaulting to np.nan for empty strings</span>
                <span class="k">def</span><span class="w"> </span><span class="nf">safe_float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="c1"># The validation callback should have already formatted the numbers,</span>
                    <span class="c1"># but this is a safeguard.</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Return NaN if the value is an empty string or cannot be converted</span>
                        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

                <span class="n">area</span> <span class="o">=</span> <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-2&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">area</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">area</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">area</span><span class="p">):</span>
                    <span class="n">absorb_coeffs</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-5&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-6&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-7&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-8&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-9&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-10&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-11&#39;</span><span class="p">)),</span>
                        <span class="n">safe_float</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-12&#39;</span><span class="p">))</span>
                    <span class="p">]</span>
                    <span class="n">mat_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-4&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;Unnamed Material&quot;</span>
                    <span class="n">surface_name</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col-1&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;Unnamed Surface&quot;</span>

                    <span class="n">material</span> <span class="o">=</span> <span class="n">reverberation_calc</span><span class="o">.</span><span class="n">material</span><span class="p">(</span><span class="n">mat_name</span><span class="p">,</span> <span class="n">absorb_coeffs</span><span class="p">)</span>
                    <span class="n">surface</span> <span class="o">=</span> <span class="n">reverberation_calc</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">surface_name</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span>
                    <span class="n">surfaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="c1"># This will now primarily catch issues if the row structure is unexpected</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">surfaces</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Valid surface data is required for calculation.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fig</span>

        <span class="c1"># Calculate reverberation time</span>
        <span class="n">reverb_obj</span> <span class="o">=</span> <span class="n">reverberation_calc</span><span class="o">.</span><span class="n">reverberation_time</span><span class="p">(</span><span class="n">calc_room</span><span class="p">,</span> <span class="n">surfaces</span><span class="p">,</span> <span class="n">air_damp_calc</span><span class="o">=</span><span class="n">air_damp_activated</span><span class="p">)</span>
        <span class="n">df_reverb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="n">reverb_obj</span><span class="o">.</span><span class="n">frequency_bands</span><span class="p">,</span>
            <span class="s1">&#39;Reverberation Time&#39;</span><span class="p">:</span> <span class="n">reverb_obj</span><span class="o">.</span><span class="n">reverberation_time</span>
        <span class="p">})</span>

        <span class="c1"># Get target reverberation time range</span>
        <span class="k">if</span> <span class="n">room_usage</span> <span class="o">!=</span> <span class="s2">&quot;no requirements&quot;</span><span class="p">:</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">reverberation_calc</span><span class="o">.</span><span class="n">DIN_18041_limits</span><span class="p">(</span><span class="n">calc_room</span><span class="p">,</span> <span class="n">room_usage</span><span class="p">)</span>
            <span class="n">df_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="n">reverb_obj</span><span class="o">.</span><span class="n">frequency_bands</span><span class="p">,</span>
                <span class="s1">&#39;T_max&#39;</span><span class="p">:</span> <span class="n">limits</span><span class="o">.</span><span class="n">T_upper_limit</span><span class="p">,</span>
                <span class="s1">&#39;T_min&#39;</span><span class="p">:</span> <span class="n">limits</span><span class="o">.</span><span class="n">T_lower_limit</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_target</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="p">(</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;T_max&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">and</span> <span class="n">room_usage</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">):</span>
            <span class="c1"># Find the first and last indices where T_max is greater than 0</span>
            <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">df_target</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;T_max&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">first_index</span> <span class="o">=</span> <span class="n">non_zero_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">last_index</span> <span class="o">=</span> <span class="n">non_zero_indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Get the corresponding frequencies</span>
            <span class="n">first_freq</span> <span class="o">=</span> <span class="n">df_target</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_index</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
            <span class="n">last_freq</span> <span class="o">=</span> <span class="n">df_target</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">last_index</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>

            <span class="c1"># Create new rows to form a rectangle</span>
            <span class="n">start_rect_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="n">first_freq</span><span class="p">,</span> <span class="s1">&#39;T_max&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;T_min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>
            <span class="n">end_rect_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;Frequency&#39;</span><span class="p">:</span> <span class="n">last_freq</span><span class="p">,</span> <span class="s1">&#39;T_max&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;T_min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}])</span>

            <span class="c1"># Insert the new rows into the DataFrame</span>
            <span class="n">df_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
                <span class="n">df_target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">first_index</span><span class="p">],</span>
                <span class="n">start_rect_row</span><span class="p">,</span>
                <span class="n">df_target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">first_index</span><span class="p">:</span><span class="n">last_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">end_rect_row</span><span class="p">,</span>
                <span class="n">df_target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">last_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


        <span class="c1"># Plotting</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">df_reverb</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span> 
            <span class="n">y</span><span class="o">=</span><span class="n">df_reverb</span><span class="p">[</span><span class="s1">&#39;Reverberation Time&#39;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Reverberation Time&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;#3DED97&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_target</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;T_max&#39;</span><span class="p">],</span>
                <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgba(255,107,107,0.5)&#39;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">))</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">df_target</span><span class="p">[</span><span class="s1">&#39;T_min&#39;</span><span class="p">],</span>
                <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tonexty&#39;</span><span class="p">,</span> <span class="c1"># fill area between trace0 and trace1</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;rgba(255,107,107,0.5)&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Tolerance Range&#39;</span><span class="p">,</span>
            <span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Reverberation Time Calculation with DIN 18041 requirements&quot;</span><span class="p">,</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Frequency in Hz&quot;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Reverberation Time in s&quot;</span><span class="p">,</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]),</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
                <span class="n">tickvals</span><span class="o">=</span><span class="n">frequency_bands</span><span class="p">,</span>
                <span class="n">ticktext</span><span class="o">=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">frequency_bands</span><span class="p">],</span>
                <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">10000</span><span class="p">)]</span>  <span class="c1"># Also set range here for consistency</span>
            <span class="p">),</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> 
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> 
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> 
                <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">itemclick</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">itemdoubleclick</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pages.home.validate_and_format_table_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_and_format_table_data</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">data_previous</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate and format the data in the area-table.
Ensures that area and alpha values are numeric and rounded to two decimal places.
Reverts invalid inputs to their previous state.</p>


            <details class="quote">
              <summary>Source code in <code>pages/home.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@callback</span><span class="p">(</span>
    <span class="n">Output</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">allow_duplicate</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">Input</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data_timestamp&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">),</span>
    <span class="n">State</span><span class="p">(</span><span class="s1">&#39;area-table&#39;</span><span class="p">,</span> <span class="s1">&#39;data_previous&#39;</span><span class="p">),</span>
    <span class="n">prevent_initial_call</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_and_format_table_data</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">data_previous</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate and format the data in the area-table.</span>
<span class="sd">    Ensures that area and alpha values are numeric and rounded to two decimal places.</span>
<span class="sd">    Reverts invalid inputs to their previous state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">data_previous</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">dash</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">PreventUpdate</span>

    <span class="c1"># If a row was added or deleted, the lengths will be different.</span>
    <span class="c1"># In this case, we don&#39;t want to validate, so we allow the update to proceed</span>
    <span class="c1"># without modification from this callback.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_previous</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="c1"># Find the changed cell</span>
    <span class="n">changed_row_idx</span><span class="p">,</span> <span class="n">changed_col_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="c1"># Using .get() to avoid KeyErrors if a column was somehow removed</span>
        <span class="n">diff_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">!=</span> <span class="n">data_previous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">diff_keys</span><span class="p">:</span>
            <span class="n">changed_row_idx</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">changed_col_id</span> <span class="o">=</span> <span class="n">diff_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">changed_row_idx</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">dash</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">PreventUpdate</span>

    <span class="c1"># List of columns to validate</span>
    <span class="n">editable_numeric_cols</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;col-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">changed_col_id</span> <span class="ow">in</span> <span class="n">editable_numeric_cols</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span>
        <span class="n">prev_value</span> <span class="o">=</span> <span class="n">data_previous</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">cleaned_value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cleaned_value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="c1"># Allow user to clear the cell</span>
                <span class="k">return</span> <span class="n">data</span>

            <span class="c1"># Check for valid float format</span>
            <span class="k">if</span> <span class="n">cleaned_value</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cleaned_value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cleaned_value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cleaned_value</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">())):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">num_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">cleaned_value</span><span class="p">)</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">num_value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="c1"># Revert if conversion fails</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Revert if format is invalid</span>
                <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># If value is None or other type, and it&#39;s a change, revert it.</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">prev_value</span><span class="p">:</span>
             <span class="n">data</span><span class="p">[</span><span class="n">changed_row_idx</span><span class="p">][</span><span class="n">changed_col_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_value</span>


    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Paula Klein, Deniz Sharideh, Linus Staubach
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://raumakustik-cad.onrender.com/" target="_blank" rel="noopener" title="RoomAcousticWizard" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M156.6 384.9 125.7 354c-8.5-8.5-11.5-20.8-7.7-32.2 3-8.9 7-20.5 11.8-33.8H24c-8.6 0-16.6-4.6-20.9-12.1s-4.2-16.7.2-24.1l52.5-88.5c13-21.9 36.5-35.3 61.9-35.3H200c2.4-4 4.8-7.7 7.2-11.3C289.1-4.1 411.1-8.1 483.9 5.3c11.6 2.1 20.6 11.2 22.8 22.8 13.4 72.9 9.3 194.8-111.4 276.7-3.5 2.4-7.3 4.8-11.3 7.2v82.3c0 25.4-13.4 49-35.3 61.9l-88.5 52.5c-7.4 4.4-16.6 4.5-24.1.2S224 496.7 224 488V380.8c-14.1 4.9-26.4 8.9-35.7 11.9-11.2 3.6-23.4.5-31.8-7.8zM384 168a40 40 0 1 0 0-80 40 40 0 1 0 0 80"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>